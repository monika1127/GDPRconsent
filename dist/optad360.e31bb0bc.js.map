{"version":3,"sources":["index.js"],"names":["displayModal","body","document","querySelector","style","width","height","overflow","modal","createElement","className","popup","innerHTML","form","formItems","buttons","acceptButton","setAttribute","rejectButton","saveForm","e","data","srcElement","inputs","querySelectorAll","acceptedContractorsId","forEach","i","checked","push","id","cookie","decision","submitter","today","Date","expiresDate","setDate","getDate","JSON","stringify","toUTCString","renderContractor","contractor","contractorElement","name","policyUrl","appendChild","fetchData","fetch","then","res","json","contractors","Object","values","vendors","c","addEventListener","currentCookies","length","cookieObject","split","map","reduce","acc","key","value","trim","decodeURIComponent","GDPR"],"mappings":"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","file":"optad360.e31bb0bc.js","sourceRoot":"..","sourcesContent":["const displayModal = () => {\r\n\r\n  //body element selector\r\n  const body = document.querySelector(\"body\");\r\n  body.style.width = \"100%\";\r\n  body.style.height = \"100%\";\r\n  body.style.overflow = \"hidden\";\r\n\r\n  // modal element created\r\n  const modal = document.createElement(\"div\");\r\n  modal.className = \"GDPR__modal\";\r\n\r\n  // popup element created\r\n  const popup = document.createElement(\"div\");\r\n  popup.className = \"GDPR__popup\";\r\n  popup.innerHTML = \"<h1>GDPR consent</h1>\";\r\n\r\n  // form element\r\n  const form = document.createElement(\"form\");\r\n  form.className = \"GDPR__form-container\";\r\n\r\n  // form items list\r\n  const formItems = document.createElement(\"div\");\r\n  formItems.className = \"GDPR__form-items\";\r\n\r\n  // form buttons\r\n  const buttons = document.createElement(\"div\");\r\n  buttons.className = \"GDPR__form-buttons\";\r\n\r\n  const acceptButton = document.createElement(\"button\");\r\n  acceptButton.innerHTML = \"ACCEPT\";\r\n  acceptButton.setAttribute(\"type\", \"submit\");\r\n  acceptButton.setAttribute(\"id\", \"accepted\");\r\n\r\n  const rejectButton = document.createElement(\"button\");\r\n  rejectButton.innerHTML = \"REJECT\";\r\n  rejectButton.setAttribute(\"type\", \"submit\");\r\n  rejectButton.setAttribute(\"id\", \"rejected\");\r\n\r\n  // buttons - onClick functions\r\n  const saveForm = (e) => {\r\n    const data = e.srcElement;\r\n    const inputs = data.querySelectorAll(\"input\");\r\n\r\n    let acceptedContractorsId = [];\r\n    inputs.forEach((i) => i.checked && acceptedContractorsId.push(i.id));\r\n\r\n    const cookie = { decision: e.submitter.id, acceptedContractorsId };\r\n\r\n    const today = new Date();\r\n    const expiresDate = new Date(today);\r\n    expiresDate.setDate(expiresDate.getDate() + 1);\r\n    document.cookie = `GDPR=${JSON.stringify(\r\n      cookie\r\n    )}; expires= ${expiresDate.toUTCString()}`;\r\n  };\r\n\r\n  // download and render contractors list\r\n  const renderContractor = (contractor) => {\r\n    const contractorElement = document.createElement(\"div\");\r\n    contractorElement.className = \"GDPR__form-item\";\r\n    contractorElement.innerHTML = `<div>\r\n            <input type=\"checkbox\" id=${contractor.id}>\r\n            <label for\"${contractor.id}\">${contractor.name}\r\n            <a href=\"${contractor.policyUrl}\">(read contractor policy)</a>\r\n            </label>\r\n        </div>`;\r\n\r\n    formItems.appendChild(contractorElement);\r\n  };\r\n\r\n  const fetchData = () => {\r\n    fetch(\"http://optad360.mgr.consensu.org/cmp/v2/vendor-list.json\")\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        const contractors = Object.values(data.vendors);\r\n        contractors.forEach((c) => renderContractor(c));\r\n      });\r\n  };\r\n\r\n  fetchData();\r\n\r\n  // display all elements\r\n  buttons.appendChild(acceptButton);\r\n  buttons.appendChild(rejectButton);\r\n  form.appendChild(formItems);\r\n  form.appendChild(buttons);\r\n  popup.appendChild(form);\r\n  modal.appendChild(popup);\r\n  document.body.appendChild(modal);\r\n\r\n  form.addEventListener(\"submit\", saveForm)\r\n};\r\n\r\n// should modal be rendered\r\nconst currentCookies = document.cookie;\r\ncurrentCookies.length ===0 && displayModal()\r\n\r\nif ((currentCookies.length > 0)) {\r\n  const cookieObject = currentCookies\r\n    .split(\";\")\r\n    .map((cookie) => cookie.split(\"=\"))\r\n    .reduce(\r\n      (acc, [key, value]) => ({\r\n        ...acc,\r\n        [key.trim()]: decodeURIComponent(value),\r\n      }),\r\n      {}\r\n    );\r\n\r\n    !cookieObject.GDPR && displayModal();\r\n}"]}